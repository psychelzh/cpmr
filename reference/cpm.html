<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform Connectome-based Predictive Modeling (CPM) — cpm • cpmr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Connectome-based Predictive Modeling (CPM) — cpm"><meta name="description" content="The connectome-based predictive modeling (CPM) is a data-driven approach to
predict individual behavior from brain connectivity data. Originally proposed
by Shen et al. (2017), the CPM has been widely used in various studies. This
function implements the CPM algorithm and provides a convenient interface to
use it."><meta property="og:description" content="The connectome-based predictive modeling (CPM) is a data-driven approach to
predict individual behavior from brain connectivity data. Originally proposed
by Shen et al. (2017), the CPM has been widely used in various studies. This
function implements the CPM algorithm and provides a convenient interface to
use it."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cpmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/psychelzh/cpmr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform Connectome-based Predictive Modeling (CPM)</h1>
      <small class="dont-index">Source: <a href="https://github.com/psychelzh/cpmr/blob/main/R/cpm.R" class="external-link"><code>R/cpm.R</code></a></small>
      <div class="d-none name"><code>cpm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The connectome-based predictive modeling (CPM) is a data-driven approach to
predict individual behavior from brain connectivity data. Originally proposed
by Shen et al. (2017), the CPM has been widely used in various studies. This
function implements the CPM algorithm and provides a convenient interface to
use it.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cpm</span><span class="op">(</span></span>
<span>  <span class="va">conmat</span>,</span>
<span>  <span class="va">behav</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  confounds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thresh_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"sparsity"</span><span class="op">)</span>,</span>
<span>  thresh_level <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  kfolds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bias_correct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_edges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"none"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  na_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fail"</span>, <span class="st">"exclude"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-conmat">conmat<a class="anchor" aria-label="anchor" href="#arg-conmat"></a></dt>
<dd><p>A matrix of connectome data. Observations in row, edges in
column (assumed that duplicated edges are removed).</p></dd>


<dt id="arg-behav">behav<a class="anchor" aria-label="anchor" href="#arg-behav"></a></dt>
<dd><p>A numeric vector contains behavior data. Length must equal to
number of observations in <code>conmat</code>. Note <code>behav</code> could also be a row/column
matrix, which will be converted to a vector using <code><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For future extension. Currently ignored.</p></dd>


<dt id="arg-confounds">confounds<a class="anchor" aria-label="anchor" href="#arg-confounds"></a></dt>
<dd><p>A matrix of confounding variables. Observations in row,
variables in column. If <code>NULL</code>, no confounding variables are used. Note if
a vector is provided, it will be converted to a column matrix.</p></dd>


<dt id="arg-thresh-method-thresh-level">thresh_method, thresh_level<a class="anchor" aria-label="anchor" href="#arg-thresh-method-thresh-level"></a></dt>
<dd><p>The threshold method and level used in edge
selection. If method is set to be <code>"alpha"</code>, the edge selection is based on
the critical value of correlation coefficient. If method is set to be
<code>"sparsity"</code>, the edge selection is based on the quantile of correlation
coefficient, thus network sparsity is controlled.</p></dd>


<dt id="arg-kfolds">kfolds<a class="anchor" aria-label="anchor" href="#arg-kfolds"></a></dt>
<dd><p>Folds number of cross-validation. If <code>NULL</code>, it will be set to
be equal to the number of observations, i.e., leave-one-subject-out.</p></dd>


<dt id="arg-bias-correct">bias_correct<a class="anchor" aria-label="anchor" href="#arg-bias-correct"></a></dt>
<dd><p>Logical value indicating if the connectome data should be
bias-corrected. If <code>TRUE</code>, the connectome data will be centered and scaled
to have unit variance based on the training data before model fitting and
prediction. See Rapuano et al. (2020) for more details.</p></dd>


<dt id="arg-return-edges">return_edges<a class="anchor" aria-label="anchor" href="#arg-return-edges"></a></dt>
<dd><p>A character string indicating the return value of the
selected edges. If <code>"none"</code>, no edges are returned. If <code>"sum"</code>, the sum of
selected edges across folds is returned. If <code>"all"</code>, the selected edges for
each fold is returned, which is a 3D array and memory-consuming.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A character string indicating the action when missing values
are found in <code>behav</code>. If <code>"fail"</code>, an error will be thrown. If <code>"exclude"</code>,
missing values will be excluded from the analysis but kept in the output.
Note complete cases are intersection of <code>conmat</code>, <code>behav</code> and <code>confounds</code>
if provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p>
<dl><dt>folds</dt>
<dd><p>The corresponding fold for each observation when used as test
group in cross-validation.</p></dd>


<dt>real</dt>
<dd><p>The real behavior data. This is the same as the input <code>behav</code>
if <code>confounds</code> is <code>NULL</code>, otherwise it is the residual of <code>behav</code> after
regressing out <code>confounds</code>.</p></dd>


<dt>pred</dt>
<dd><p>The predicted behavior data, with each column corresponding to
a model, i.e., both edges, positive edges, negative edges, and the row
names corresponding to the observation names (the same as those of
<code>behav</code>).</p></dd>


<dt>edges</dt>
<dd><p>The selected edges, if <code>return_edges</code> is not <code>"none"</code>. If
<code>return_edges</code> is <code>"sum"</code>, it is a matrix with rows corresponding to
edges and columns corresponding to networks. If <code>return_edges</code> is
<code>"all"</code>, it is a 3D array with dimensions corresponding to edges,
networks and folds.</p></dd>


<dt>call</dt>
<dd><p>The matched call.</p></dd>


<dt>params</dt>
<dd><p>A list of parameters used in the function, including:</p><ul><li><p><code>confounds</code> indicating if confounds are used</p></li>
<li><p><code>thresh_method</code> indicating the threshold method</p></li>
<li><p><code>thresh_level</code> indicating the threshold level</p></li>
<li><p><code>kfolds</code> indicating the number of folds in cross-validation</p></li>
<li><p><code>bias_correct</code> indicating if bias correction is used</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Shen, X., Finn, E. S., Scheinost, D., Rosenberg, M. D., Chun, M. M.,
Papademetris, X., &amp; Constable, R. T. (2017). Using connectome-based
predictive modeling to predict individual behavior from brain connectivity.
Nature Protocols, 12(3), 506–518. https://doi.org/10.1038/nprot.2016.178</p>
<p>Rapuano, K. M., Rosenberg, M. D., Maza, M. T., Dennis, N. J., Dorji, M.,
Greene, A. S., Horien, C., Scheinost, D., Todd Constable, R., &amp; Casey, B. J.
(2020). Behavioral and brain signatures of substance use vulnerability in
childhood. Developmental Cognitive Neuroscience, 46, 100878.
https://doi.org/10.1016/j.dcn.2020.100878</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">conmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">behav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cpm</span><span class="op">(</span><span class="va">conmat</span>, <span class="va">behav</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CPM results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Call: cpm(conmat = conmat, behav = behav)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of observations: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Complete cases: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of edges: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Confounds:        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold method: alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold level:  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CV folds:         100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bias correction:  TRUE</span>
<span class="r-in"><span><span class="co"># use different threshold method and level</span></span></span>
<span class="r-in"><span><span class="fu">cpm</span><span class="op">(</span><span class="va">conmat</span>, <span class="va">behav</span>, thresh_method <span class="op">=</span> <span class="st">"sparsity"</span>, thresh_level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CPM results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Call: cpm(conmat = conmat, behav = behav, thresh_method = "sparsity", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     thresh_level = 0.05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of observations: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Complete cases: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of edges: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Confounds:        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold method: sparsity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold level:  0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CV folds:         100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bias correction:  TRUE</span>
<span class="r-in"><span><span class="co"># use a 10-fold cross-validation</span></span></span>
<span class="r-in"><span><span class="fu">cpm</span><span class="op">(</span><span class="va">conmat</span>, <span class="va">behav</span>, kfolds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CPM results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Call: cpm(conmat = conmat, behav = behav, kfolds = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of observations: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Complete cases: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of edges: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Confounds:        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold method: alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Threshold level:  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CV folds:         10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Bias correction:  TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Liang Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

